webpackJsonp([5],{1967:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(23),d=n.n(u),p=n(2035),h=n(2185),f=n(2001),m=n(803),g=n.n(m),y=n(397),v=n.n(y),b=n(2470),_=n(2469),w=n(72),S=n(233),T=n(2070),C=n(2359),O=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),x=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),E={heading:{paddingBottom:18},fab:{textAlign:"right",marginTop:"1rem",bottom:"1.5rem",right:"1.5rem",position:"fixed",zIndex:10}},k=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.handleTranslationSaved=function(){w.a.show({message:"translation_saved",translate:!0})},o.handleTranslationErrored=function(e){d.a.error(e),w.a.show({message:"translation_save_error",action:"ok",translate:!0})},o.state={categoryCombos:null,editSectionModel:!1,greyFieldSectionModel:!1},Promise.all([n.d2.Api.getApi().get(["dataSets",e.params.modelId,"categoryCombos"].join("/"),{fields:"id,displayName",paging:!1})]).then(function(e){var t=O(e,1),n=t[0],r=S.a.state.sections,a=Array.isArray(r)?r:r.toArray();o.setState({sections:a.sort(function(e,t){return e.sortOrder-t.sortOrder}),categoryCombos:n.categoryCombos.map(function(e){return{value:e.id,text:"default"===e.displayName?o.getTranslation("none"):e.displayName}})})}),o.handleAddSectionClick=o.handleAddSectionClick.bind(o),o.handleEditSectionClick=o.handleEditSectionClick.bind(o),o.handleSectionSaved=o.handleSectionSaved.bind(o),o.handleDeleteSectionClick=o.handleDeleteSectionClick.bind(o),o.handleTranslateSectionClick=o.handleTranslateSectionClick.bind(o),o.handleTranslationSaved=o.handleTranslationSaved.bind(o),o.handleTranslationErrored=o.handleTranslationErrored.bind(o),o.handleSectionGreyFieldsClick=o.handleSectionGreyFieldsClick.bind(o),o.swapSections=o.swapSections.bind(o),o.moveSectionUp=o.moveSectionUp.bind(o),o.moveSectionDown=o.moveSectionDown.bind(o),o.getTranslation=n.d2.i18n.getTranslation.bind(n.d2.i18n),o}return o(t,e),x(t,[{key:"handleAddSectionClick",value:function(){var e=this.context.d2.models.sections.create();this.setState(function(t){return{editSectionModel:Object.assign(e,{dataSet:{id:S.a.state.id},sortOrder:t.sections.reduce(function(e,t){return Math.max(t.sortOrder,e)},0)+1})}})}},{key:"handleEditSectionClick",value:function(e){this.setState({editSectionModel:e})}},{key:"handleSectionSaved",value:function(e){var t=this;this.setState(function(t){var n=!1,r=t.sections.map(function(t){return t.id===e.id?(n=!0,e):t}).sort(function(e,t){return e.sortOrder-t.sortOrder});return n||r.push(e),S.a.setState(Object.assign(S.a.state,{sections:r})),{editSectionModel:!1,greyFieldSectionModel:!1,sections:r}},function(){t.forceUpdate()})}},{key:"handleDeleteSectionClick",value:function(e){var t=this;w.a.show({message:this.getTranslation("confirm_delete_section")+" "+e.displayName,action:"confirm",onActionTouchTap:function(){e.delete().then(function(){var n=S.a.state.sections;S.a.setState(Object.assign(S.a.state,{sections:(Array.isArray(n)?n:n.toArray()).filter(function(t){return t.id!==e.id})})),w.a.show({message:t.getTranslation("section_deleted")}),t.setState(function(t){return{sections:t.sections.filter(function(t){return t.id!==e.id})}})}).catch(function(e){w.a.show({message:t.getTranslation("failed_to_delete_section"),action:"ok"}),d.a.warn("Failed to delete section",e)})}})}},{key:"handleTranslateSectionClick",value:function(e){this.setState({translationModel:e})}},{key:"handleSectionGreyFieldsClick",value:function(e){this.setState({greyFieldSectionModel:e})}},{key:"swapSections",value:function(e,t){var n=this;this.setState(function(r){var a=e.sortOrder;return e.sortOrder=t.sortOrder,t.sortOrder=a,Promise.all([e.save(),t.save()]).then(function(){w.a.show({message:n.getTranslation("section_moved")})}).catch(function(e){d.a.warn("Failed to swap sections:",e),w.a.show({message:n.getTranslation("failed_to_move_section"),action:"ok"})}),{sections:r.sections.sort(function(e,t){return e.sortOrder-t.sortOrder})}})}},{key:"moveSectionUp",value:function(e){var t=this.state.sections.indexOf(e);if(t>0){var n=this.state.sections[t-1];this.swapSections(n,e)}}},{key:"moveSectionDown",value:function(e){var t=this.state.sections.indexOf(e);if(t<this.state.sections.length-1){var n=this.state.sections[t+1];this.swapSections(n,e)}}},{key:"render",value:function(){var e=this,t={edit:this.handleEditSectionClick,delete:this.handleDeleteSectionClick,translate:this.handleTranslateSectionClick,manage_grey_fields:this.handleSectionGreyFieldsClick,move_up:this.moveSectionUp,move_down:this.moveSectionDown},n={edit:"edit",move_up:"arrow_upward",move_down:"arrow_downward",manage_grey_fields:"do_not_disturb"},r=function(t,n){return"move_up"===n?e.state.sections.indexOf(t)>0:"move_down"!==n||e.state.sections.indexOf(t)<e.state.sections.length-1};return void 0===this.state.sections?s.a.createElement(h.a,null):s.a.createElement("div",null,s.a.createElement(T.a,{schema:"dataSet",groupName:"dataSetSection"},"section_management"),s.a.createElement(C.a,null,S.a.state.displayName),s.a.createElement(f.a,{columns:["name"],rows:this.state.sections,contextMenuActions:t,contextMenuIcons:n,primaryAction:t.edit,isContextActionAllowed:r}),s.a.createElement(b.a,{open:!!this.state.editSectionModel,sectionModel:this.state.editSectionModel,categoryCombos:this.state.categoryCombos,onRequestClose:function(){e.setState({editSectionModel:!1})},onSaveSection:this.handleSectionSaved}),s.a.createElement(_.a,{open:!!this.state.greyFieldSectionModel,sectionModel:this.state.greyFieldSectionModel,onRequestClose:function(){e.setState({greyFieldSectionModel:!1})},onRequestSave:this.handleSectionSaved}),this.state.translationModel?s.a.createElement(p.a,{objectToTranslate:this.state.translationModel,objectTypeToTranslate:this.state.translationModel&&this.state.translationModel.modelDefinition,open:!!this.state.translationModel,onTranslationSaved:this.handleTranslationSaved,onTranslationError:this.handleTranslationErrored,onRequestClose:function(){e.setState({translationModel:null})},fieldsToTranslate:["name"]}):null,s.a.createElement("div",{style:E.fab},s.a.createElement(g.a,{onClick:this.handleAddSectionClick},s.a.createElement(v.a,{className:"material-icons"},"add"))))}}]),t}(i.Component);k.propTypes={params:c.a.any.isRequired},k.contextTypes={d2:c.a.any.isRequired},t.default=k},1978:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),l=n.n(s),c=n(1),u=n.n(c),d=n(788),p=n.n(d),h=n(105),f=n.n(h),m=n(125),g=n.n(m),y=n(232),v=n.n(y),b=n(166),_=n.n(b),w=n(234),S=n.n(w),T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O=function(e){function t(e,n){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onChange=function(e,t,n){r.props.onChange({target:{value:n}})},r.getOptionText=function(e){return e&&r.state.options.length?r.state.options.find(function(t){return t.value===e}).text:""},r.closeDialog=function(){r.setState({dialogOpen:!1})},r.openDialog=function(){r.setState({dialogOpen:!0,filterText:""})},r.textFieldOnChange=function(e,t){r.setState({filterText:t})},r.renderDialogOption=function(e,t){return l.a.createElement("div",{style:{cursor:"pointer",margin:8},key:e,onClick:function(){r.props.onChange({target:{value:e}}),r.setState({dialogOpen:!1,value:e})}},l.a.createElement("a",null,t))},r.renderOptions=function(){var e=r.state.options.map(function(e){return l.a.createElement(S.a,{primaryText:e.text,key:e.value,value:e.value,label:e.text})});return r.props.isRequired||e.unshift([l.a.createElement(S.a,{primaryText:r.getTranslation("no_value"),key:"no_value",value:null,label:" "})]),e},r.getTranslation=n.d2.i18n.getTranslation.bind(n.d2.i18n),r.state={value:r.props.value,options:r.getOptions(r.props.options,r.props.isRequired),dialogOpen:!1},r}return i(t,e),C(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({options:this.getOptions(e.options,e.isRequired)})}},{key:"getOptions",value:function(e){var t=this;return e.map(function(e){return{value:e.value,text:e.text}}).map(function(e){return e.text&&t.props.translateOptions&&(e.text=g()(e.text)?t.getTranslation(e.text.toLowerCase()):e.text),e})}},{key:"renderSelectField",value:function(e){return l.a.createElement(p.a,T({value:this.state.value,fullWidth:this.props.fullWidth,errorText:this.props.errorText},e,{onChange:this.onChange,floatingLabelText:this.props.labelText}),this.renderOptions())}},{key:"renderDialogDropDown",value:function(e){var t=this,n={fieldStyle:{width:this.props.fullWidth?"100%":"inherit",position:"relative",top:this.props.top},openInNew:{position:"absolute",top:36,right:10,color:"rgba(0,0,0,0.25)",cursor:"pointer"}};return l.a.createElement("div",{style:n.fieldStyle},l.a.createElement(v.a,{title:this.props.labelText,open:this.state.dialogOpen,onRequestClose:this.closeDialog,autoScrollBodyContent:!0,autoDetectWindowHeight:!0,actions:[l.a.createElement(_.a,{onClick:this.closeDialog,label:this.getTranslation("cancel")})]},l.a.createElement(f.a,{floatingLabelText:"Filter list",onChange:this.textFieldOnChange,style:n.textField}),!this.props.isRequired&&this.renderDialogOption(null,this.getTranslation("no_value")),this.state.options.filter(function(e){return!t.state.filterText||t.state.filterText.trim().toLocaleLowerCase().split(" ").every(function(t){return e.text.toLocaleLowerCase().includes(t.toLocaleLowerCase())})}).map(function(e){return t.renderDialogOption(e.value,e.text)})),l.a.createElement(f.a,T({},e,{fullWidth:this.props.fullWidth,value:this.getOptionText(this.state.value),onClick:this.openDialog,onChange:this.openDialog,style:n.textField,floatingLabelText:this.props.labelText,inputStyle:{cursor:"pointer"}})),l.a.createElement("div",{style:n.openInNew,className:"material-icons",onClick:this.openDialog},"open_in_new"))}},{key:"render",value:function(){var e=this.props,t=(e.onFocus,e.onBlur,e.labelText,e.modelDefinition,e.models,e.referenceType,e.referenceProperty,e.isInteger,e.translateOptions,e.isRequired,e.options,e.model,e.limit),n=(e.fullWidth,e.top,e.translateLabel,e.style),a=r(e,["onFocus","onBlur","labelText","modelDefinition","models","referenceType","referenceProperty","isInteger","translateOptions","isRequired","options","model","limit","fullWidth","top","translateLabel","style"]);return n&&n.display&&"none"===n.display?null:this.state.options.length>t?this.renderDialogDropDown(a):this.renderSelectField(a)}}]),t}(s.Component);O.propTypes={onFocus:u.a.func,onBlur:u.a.func,onChange:u.a.func,fullWidth:u.a.bool,translateOptions:u.a.bool,isInteger:u.a.bool,isRequired:u.a.bool,limit:u.a.number,top:u.a.any,style:u.a.any,value:u.a.oneOfType([u.a.bool,u.a.string]),labelText:u.a.string,errorText:u.a.string,translateLabel:u.a.bool,referenceProperty:u.a.string,modelDefinition:u.a.object,models:u.a.object,model:u.a.object,referenceType:u.a.object,options:u.a.array.isRequired},O.defaultProps={onFocus:function(){},onBlur:function(){},onChange:function(){},limit:50,translateOptions:!1,isRequired:!1,fullWidth:!0,isInteger:!1,top:void 0,style:void 0,value:"",labelText:"",errorText:"",translateLabel:!1,referenceProperty:"",modelDefinition:{},models:{},model:{},referenceType:{}},O.contextTypes={d2:l.a.PropTypes.any},t.a=O},1979:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e){var t=e.level,n=e.text,a=e.style,o=e.children,s=r(e,["level","text","style","children"]),l={type:t<=6?"h"+t:"span"},u=c({fontSize:24,fontWeight:300,color:"rgba(0, 0, 0, 0.87)",padding:"16px 0 5px 0",margin:0},a);return i.a.createElement(l.type,c({},s,{style:u}),o||n)}var o=n(0),i=n.n(o),s=n(1),l=n.n(s),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};a.propTypes={level:l.a.oneOf([1,2,3,4,5,6]),text:l.a.string},a.defaultProps={level:1},t.a=a},1982:function(e,t,n){"use strict";function r(e){return e.d2&&e.d2.i18n&&n.i(s.isFunction)(e.d2.i18n.getTranslation)}function a(e,t){return n.i(s.isString)(e.children)?r(t)?i.a.createElement("span",null,t.d2.i18n.getTranslation(e.children)):(c.a.error("<Translate />: d2 is not available on the `context`"),i.a.createElement("span",null)):(c.a.error("<Translate /> requires a string to be passed as a child in order for it to translate. e.g. <Translate>string_to_translate</Translate>"),i.a.createElement("span",null))}var o=n(0),i=n.n(o),s=n(32),l=(n.n(s),n(23)),c=n.n(l),u=n(389);t.a=n.i(u.a)(a)},1989:function(e,t,n){"use strict";function r(){}function a(e){var t;return e=(e+"").trim().toLowerCase(),(t=S.exec(e))?(t=parseInt(t[1],16),new c(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1)):(t=T.exec(e))?o(parseInt(t[1],16)):(t=C.exec(e))?new c(t[1],t[2],t[3],1):(t=O.exec(e))?new c(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=x.exec(e))?i(t[1],t[2],t[3],t[4]):(t=E.exec(e))?i(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=k.exec(e))?d(t[1],t[2]/100,t[3]/100,1):(t=A.exec(e))?d(t[1],t[2]/100,t[3]/100,t[4]):j.hasOwnProperty(e)?o(j[e]):"transparent"===e?new c(NaN,NaN,NaN,0):null}function o(e){return new c(e>>16&255,e>>8&255,255&e,1)}function i(e,t,n,r){return r<=0&&(e=t=n=NaN),new c(e,t,n,r)}function s(e){return e instanceof r||(e=a(e)),e?(e=e.rgb(),new c(e.r,e.g,e.b,e.opacity)):new c}function l(e,t,n,r){return 1===arguments.length?s(e):new c(e,t,n,null==r?1:r)}function c(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function u(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function d(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new f(e,t,n,r)}function p(e){if(e instanceof f)return new f(e.h,e.s,e.l,e.opacity);if(e instanceof r||(e=a(e)),!e)return new f;if(e instanceof f)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,i=Math.min(t,n,o),s=Math.max(t,n,o),l=NaN,c=s-i,u=(s+i)/2;return c?(l=t===s?(n-o)/c+6*(n<o):n===s?(o-t)/c+2:(t-n)/c+4,c/=u<.5?s+i:2-s-i,l*=60):c=u>0&&u<1?0:l,new f(l,c,u,e.opacity)}function h(e,t,n,r){return 1===arguments.length?p(e):new f(e,t,n,null==r?1:r)}function f(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function m(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t.c=r,n.d(t,"e",function(){return y}),n.d(t,"d",function(){return v}),t.h=a,t.b=s,t.g=l,t.a=c,t.f=h;var g=n(1990),y=.7,v=1/y,b="\\s*([+-]?\\d+)\\s*",_="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",w="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",S=/^#([0-9a-f]{3})$/,T=/^#([0-9a-f]{6})$/,C=new RegExp("^rgb\\("+[b,b,b]+"\\)$"),O=new RegExp("^rgb\\("+[w,w,w]+"\\)$"),x=new RegExp("^rgba\\("+[b,b,b,_]+"\\)$"),E=new RegExp("^rgba\\("+[w,w,w,_]+"\\)$"),k=new RegExp("^hsl\\("+[_,w,w]+"\\)$"),A=new RegExp("^hsla\\("+[_,w,w,_]+"\\)$"),j={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};n.i(g.a)(r,a,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),n.i(g.a)(c,l,n.i(g.b)(r,{brighter:function(e){return e=null==e?v:Math.pow(v,e),new c(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?y:Math.pow(y,e),new c(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+u(this.r)+u(this.g)+u(this.b)},toString:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(1===e?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),n.i(g.a)(f,h,n.i(g.b)(r,{brighter:function(e){return e=null==e?v:Math.pow(v,e),new f(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?y:Math.pow(y,e),new f(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new c(m(e>=240?e-240:e+120,a,r),m(e,a,r),m(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}))},1990:function(e,t,n){"use strict";function r(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}t.b=r,t.a=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e}},1991:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(785),d=n.n(u),p=n(781),h=n.n(p),f=n(24),m=(n.n(f),n(782)),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();f.config.i18n.strings.add("selected"),f.config.i18n.strings.add("assign_all"),f.config.i18n.strings.add("remove_all"),f.config.i18n.strings.add("hidden_by_filters");var y=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.state={selectedLeft:0,selectedRight:0,loading:!0},o.onAssignItems=function(){o.setState({loading:!0}),o.props.onAssignItems([].map.call(o.leftSelect.selectedOptions,function(e){return e.value})).then(function(){o.clearSelection(),o.setState({loading:!1})}).catch(function(){o.setState({loading:!1})})},o.onRemoveItems=function(){o.setState({loading:!0}),o.props.onRemoveItems([].map.call(o.rightSelect.selectedOptions,function(e){return e.value})).then(function(){o.clearSelection(),o.setState({loading:!1})}).catch(function(){o.setState({loading:!1})})},o.onAssignAll=function(){o.setState({loading:!0}),o.props.onAssignItems([].map.call(o.leftSelect.options,function(e){return e.value})).then(function(){o.clearSelection(),o.setState({loading:!1})}).catch(function(){o.setState({loading:!1})})},o.onRemoveAll=function(){o.setState({loading:!0}),o.props.onRemoveItems([].map.call(o.rightSelect.options,function(e){return e.value})).then(function(){o.clearSelection(),o.setState({loading:!1})}).catch(function(){o.setState({loading:!1})})},o.byAssignedItemsOrder=function(e,t){var n=o.props.assignedItemStore.state;return Array.isArray(n)?n.indexOf(e.value)>n.indexOf(t.value)?1:-1:0};var i=o.context.d2.i18n;return o.getTranslation=i.getTranslation.bind(i),o}return o(t,e),g(t,[{key:"componentDidMount",value:function(){var e=this;this.disposables=[],this.disposables.push(this.props.itemStore.subscribe(function(t){return e.setState({loading:!t})})),this.disposables.push(this.props.assignedItemStore.subscribe(function(){return e.forceUpdate()}))}},{key:"componentWillReceiveProps",value:function(e){e.hasOwnProperty("filterText")&&this.leftSelect&&this.rightSelect&&this.setState({selectedLeft:[].filter.call(this.leftSelect.selectedOptions,function(t){return-1!==t.text.toLowerCase().indexOf((""+e.filterText).trim().toLowerCase())}).length,selectedRight:[].filter.call(this.rightSelect.selectedOptions,function(t){return-1!==t.text.toLowerCase().indexOf((""+e.filterText).trim().toLowerCase())}).length})}},{key:"componentWillUnmount",value:function(){this.disposables.forEach(function(e){e.unsubscribe()})}},{key:"getItemStoreIsCollection",value:function(){return void 0!==this.props.itemStore.state&&"function"==typeof this.props.itemStore.state.values&&"function"==typeof this.props.itemStore.state.has}},{key:"getItemStoreIsArray",value:function(){return void 0!==this.props.itemStore.state&&"Array"===this.props.itemStore.state.constructor.name}},{key:"getAssignedItemStoreIsCollection",value:function(){return void 0!==this.props.assignedItemStore.state&&"function"==typeof this.props.assignedItemStore.state.values&&"function"==typeof this.props.assignedItemStore.state.has}},{key:"getAssignedItemStoreIsArray",value:function(){return void 0!==this.props.assignedItemStore.state&&"Array"===this.props.assignedItemStore.state.constructor.name}},{key:"getAllItems",value:function(){return this.getItemStoreIsCollection()?Array.from(this.props.itemStore.state.values()).map(function(e){return{value:e.id,text:e.name}}):this.props.itemStore.state||[]}},{key:"getItemCount",value:function(){return this.getItemStoreIsCollection()&&this.props.itemStore.state.size||this.getItemStoreIsArray()&&this.props.itemStore.state.length||0}},{key:"getIsValueAssigned",value:function(e){return this.getAssignedItemStoreIsCollection()?this.props.assignedItemStore.state.has(e):this.props.assignedItemStore.state&&-1!==this.props.assignedItemStore.state.indexOf(e)}},{key:"getAssignedItems",value:function(){var e=this;return this.getAllItems().filter(function(t){return e.getIsValueAssigned(t.value)})}},{key:"getAvailableItems",value:function(){var e=this;return this.getAllItems().filter(function(t){return!e.getIsValueAssigned(t.value)})}},{key:"getAllItemsFiltered",value:function(){return this.filterItems(this.getAllItems())}},{key:"getAssignedItemsFiltered",value:function(){return this.filterItems(this.getAssignedItems())}},{key:"getAvailableItemsFiltered",value:function(){return this.filterItems(this.getAvailableItems())}},{key:"getAssignedItemsCount",value:function(){return this.getAssignedItems().length}},{key:"getAvailableItemsCount",value:function(){return this.getAvailableItems().length}},{key:"getAssignedItemsFilterCount",value:function(){return 0===this.getFilterText().length?0:this.getAssignedItems().length-this.getAssignedItemsFiltered().length}},{key:"getAvailableItemsFilterCount",value:function(){return 0===this.getFilterText().length?0:this.getAvailableItems().length-this.getAvailableItemsFiltered().length}},{key:"getAssignedItemsUnfilteredCount",value:function(){return 0===this.getFilterText().length?this.getAssignedItemsCount():this.getAssignedItemsCount()-this.getAssignedItemsFilterCount()}},{key:"getAvailableItemsUnfilteredCount",value:function(){return 0===this.getFilterText().length?this.getAvailableItemsCount():this.getAvailableItemsCount()-this.getAvailableItemsFilterCount()}},{key:"getFilterText",value:function(){return this.props.filterText?this.props.filterText.trim().toLowerCase():""}},{key:"getAvailableSelectedCount",value:function(){return Math.max(this.state.selectedLeft,0)}},{key:"getAssignedSelectedCount",value:function(){return Math.max(this.state.selectedRight,0)}},{key:"getSelectedCount",value:function(){return Math.max(this.getAvailableSelectedCount(),this.getAssignedSelectedCount())}},{key:"getSelectedItems",value:function(){return[].map.call(this.rightSelect.selectedOptions,function(e){return e.value})}},{key:"clearSelection",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(this.leftSelect.selectedIndex=-1),t&&(this.rightSelect.selectedIndex=-1),this.setState(function(n){return{selectedLeft:e?0:n.selectedLeft,selectedRight:t?0:n.selectedRight}})}},{key:"filterItems",value:function(e){var t=this;return e.filter(function(e){return 0===t.getFilterText().length||-1!==e.text.trim().toLowerCase().indexOf(t.getFilterText())})}},{key:"render",value:function(){var e=this,t=this.getFilterText().length>0?15:0,n={container:{display:"flex",marginTop:16,marginBottom:32,height:this.props.height+"px"},left:{flex:"1 0 120px"},middle:{flex:"0 0 120px",alignSelf:"center",textAlign:"center"},right:{flex:"1 0 120px"},paper:{width:"100%",height:"100%"},select:{width:"100%",minHeight:"50px",height:this.props.height-t+"px",border:"none",fontFamily:"Roboto",fontSize:13,outline:"none"},options:{padding:".25rem .5rem"},buttons:{minWidth:"100px",maxWidth:"100px",marginTop:"8px"},selected:{fontSize:13,minHeight:"15px",marginTop:"45px",padding:"0 8px"},status:{marginTop:"8px",minHeight:"60px"},hidden:{fontSize:13,color:"#404040",fontStyle:"italic",textAlign:"center",width:"100%",background:"#d0d0d0",maxHeight:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},r=function(t){e.clearSelection(!1,!0),e.setState({selectedLeft:t.target.selectedOptions.length})},a=function(t){e.clearSelection(!0,!1),e.setState({selectedRight:t.target.selectedOptions.length})},o=function(t){return e.getItemCount()>0&&e.getFilterText().length>0?t+" "+e.getTranslation("hidden_by_filters"):""};return s.a.createElement("div",{style:n.container},s.a.createElement("div",{style:n.left},s.a.createElement(d.a,{style:n.paper},s.a.createElement("div",{style:n.hidden},o(this.getAvailableItemsFilterCount())),s.a.createElement("select",{multiple:!0,style:n.select,onChange:r,ref:function(t){e.leftSelect=t}},this.getAvailableItemsFiltered().map(function(t){return s.a.createElement("option",{key:t.value,value:t.value,onDoubleClick:e.onAssignItems,style:n.options},t.text)}))),s.a.createElement(h.a,{label:this.getTranslation("assign_all")+" "+(0===this.getAvailableItemsUnfilteredCount()?"":this.getAvailableItemsUnfilteredCount())+" →",disabled:this.state.loading||0===this.getAvailableItemsUnfilteredCount(),onClick:this.onAssignAll,style:{marginTop:"1rem"},secondary:!0})),s.a.createElement("div",{style:n.middle},s.a.createElement("div",{style:n.selected},function(){return e.getSelectedCount()>0?e.getSelectedCount()+" "+e.getTranslation("selected"):""}()),s.a.createElement(h.a,{label:"→",secondary:!0,onClick:this.onAssignItems,style:n.buttons,disabled:this.state.loading||0===this.state.selectedLeft}),s.a.createElement(h.a,{label:"←",secondary:!0,onClick:this.onRemoveItems,style:n.buttons,disabled:this.state.loading||0===this.state.selectedRight}),s.a.createElement("div",{style:n.status},this.state.loading?s.a.createElement(m.a,{small:!0,style:{width:60,height:60}}):void 0)),s.a.createElement("div",{style:n.right},s.a.createElement(d.a,{style:n.paper},s.a.createElement("div",{style:n.hidden},o(this.getAssignedItemsFilterCount())),s.a.createElement("select",{multiple:!0,style:n.select,onChange:a,ref:function(t){e.rightSelect=t}},this.getAssignedItemsFiltered().sort(this.byAssignedItemsOrder).map(function(t){return s.a.createElement("option",{key:t.value,value:t.value,onDoubleClick:e.onRemoveItems,style:n.options},t.text)}))),s.a.createElement(h.a,{label:"← "+this.getTranslation("remove_all")+" "+(this.getAssignedItemsUnfilteredCount()>0?this.getAssignedItemsUnfilteredCount():""),style:{float:"right",marginTop:"1rem"},disabled:this.state.loading||0===this.getAssignedItemsUnfilteredCount(),onClick:this.onRemoveAll,secondary:!0})))}}]),t}(i.Component);y.propTypes={itemStore:c.a.object.isRequired,assignedItemStore:c.a.object.isRequired,filterText:c.a.string,onAssignItems:c.a.func.isRequired,onRemoveItems:c.a.func.isRequired,onMoveItems:c.a.func,height:c.a.number},y.contextTypes={d2:c.a.object},y.defaultProps={height:500,filterText:"",onMoveItems:function(){}},t.a=y},1992:function(e,t,n){"use strict";var r=n(1989);n.d(t,"f",function(){return r.h}),n.d(t,"e",function(){return r.g}),n.d(t,"d",function(){return r.f});var a=n(2066);n.d(t,"c",function(){return a.b}),n.d(t,"a",function(){return a.a});var o=n(2065);n.d(t,"b",function(){return o.a})},1999:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=Math.PI/180,a=180/Math.PI},2001:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(806),d=n.n(u),p=n(798),h=n.n(p),f=n(2055),m=n(2056),g=n(2054),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=function(e){function t(){var e,n,o,i;r(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=o=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.state=o.getStateFromProps(o.props),o.handleRowClick=function(e,t){var n=e.currentTarget;o.setState(function(e){return{contextMenuTarget:n,showContextMenu:!0,activeRow:t!==e.activeRow?t:void 0}})},o.hideContextMenu=function(){o.setState({activeRow:void 0,showContextMenu:!1})},o.hasContextMenu=function(){return Object.keys(o.props.contextMenuActions||{}).length>1},o.hasSingleAction=function(){return 1===Object.keys(o.props.contextMenuActions||{}).length},i=n,a(o,i)}return o(t,e),y(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(this.getStateFromProps(e))}},{key:"getStateFromProps",value:function(e){var t=[];return h()(e.rows)&&(t=e.rows instanceof Map?Array.from(e.rows.values()):e.rows),{columns:d()(e.columns)?e.columns:["name","lastUpdated"],dataRows:t,activeRow:void 0}}},{key:"renderRows",value:function(){var e=this;return this.state.dataRows.map(function(t,n){return s.a.createElement(m.a,{key:n,dataSource:t,columns:e.state.columns,isActive:e.state.activeRow===n,itemClicked:e.handleRowClick,primaryClick:e.props.primaryAction||function(){},contextMenuActions:e.props.contextMenuActions,contextMenuIcons:e.props.contextMenuIcons})})}},{key:"renderHeaders",value:function(){return this.state.columns.map(function(e,t){return s.a.createElement(f.a,{key:e,isOdd:Boolean(t%2),name:e})})}},{key:"renderContextMenu",value:function(){var e=this,t=this.props.isContextActionAllowed&&this.props.isContextActionAllowed.bind(null,this.state.activeRow)||function(){return!0},n=Object.keys(this.props.contextMenuActions||{}).filter(t).reduce(function(t,n){return t[n]=e.props.contextMenuActions[n],t},{});return s.a.createElement(g.a,{target:this.state.contextMenuTarget,onRequestClose:this.hideContextMenu,actions:n,activeItem:this.state.activeRow,icons:this.props.contextMenuIcons})}},{key:"render",value:function(){return s.a.createElement("div",{className:"data-table"},s.a.createElement("div",{className:"data-table__headers"},this.renderHeaders(),(this.hasContextMenu()||this.hasSingleAction())&&s.a.createElement(f.a,null,this.props.contextMenuHeader)),s.a.createElement("div",{className:"data-table__rows"},this.renderRows()),this.hasContextMenu()&&this.renderContextMenu())}}]),t}(i.Component);v.propTypes={contextMenuActions:c.a.object,contextMenuIcons:c.a.object,primaryAction:c.a.func,isContextActionAllowed:c.a.func,contextMenuHeader:c.a.node},t.a=v},2015:function(e,t,n){"use strict";function r(e){return e&&v.a[e]}function a(e){var t=e.major,n=e.minor;return e.snapshot?"master":t+"."+n}function o(e,t){var n=/\$\{(.+?)\}/g;return e.replace(n,function(e,n){return t.has(n)?t.get(n):".+?"})}function i(e,t){return Object.keys(v.a).find(function(n){var r=o(n,t);return new RegExp(r).test(e)})}function s(e,t){return r(e)?o(v.a[e],t):""}function l(e,t){var r=new Map([["objectType",t]]),a=new Map([["objectType",n.i(g.camelCaseToUnderscores)(t)]]);return s(i(e,r),a)}function c(e,t){var n=e.schema,r=t.d2,o=window.location.hash.replace(/^#/,"").replace(/\?.+?$/,""),i="https://ci.dhis2.org/docs/"+a(r.system.version),s=l(o,n);return s?d.a.createElement(m.a,{href:""+i+s,target:"_blank",rel:"noopener noreferrer",tooltip:r.i18n.getTranslation("open_user_guide"),tooltipPosition:"bottom-center",iconClassName:"material-icons",iconStyle:{top:-2}},"help_outline"):null}t.a=c;var u=n(0),d=n.n(u),p=n(1),h=n.n(p),f=n(104),m=n.n(f),g=n(399),y=(n.n(g),n(2026)),v=n.n(y);c.propTypes={schema:h.a.string.isRequired},c.contextTypes={d2:h.a.object}},2021:function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.value,n=void 0===t?"":t,r={width:"100%",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",position:"absolute",wordBreak:"break-all",wordWrap:"break-word",top:0,lineHeight:"50px",paddingRight:"1rem"},a=n.toString();return v.a.createElement("span",{title:a,style:r},a)}function s(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return n.i(b.isNil)(t)?"":void 0!==e.Intl&&Intl.DateTimeFormat?new Intl.DateTimeFormat(r,{year:"numeric",month:"long",day:"numeric"}).format(new Date(t)):t.substr(0,19).replace("T"," ")}function l(e){var t=e.value&&(e.value.displayName||e.value.name);return v.a.createElement(i,T({},e,{value:t}))}function c(e){var t=e.valueType,n=e.value;return"DATE"===t||x.test(n)}function u(e){return/#([a-z0-9]{6})$/i.test(e.value)}function d(e){var t=e.value;return t&&(t.displayName||t.name)}function p(e){var t=e.value;if(t){var n=t.substr(0,2),r=t.substr(2,2);if("----"===t.substr(4,4)&&("--"===r||"r-"===r||"rw"===r)){if("rw"===n)return v.a.createElement(w.a,null,"public_can_edit");if("r-"===n)return v.a.createElement(w.a,null,"public_can_view");if("--"===n)return v.a.createElement(w.a,null,"public_none")}}return v.a.createElement(i,{value:t})}function h(e){return"publicAccess"===e.columnName}function f(e,t){return E.unshift([e,t]),function(){var t=new Map(E);t.delete(e),E=Array.from(t)}}t.b=f,n.d(t,"a",function(){return k});var m=n(1),g=n.n(m),y=n(0),v=n.n(y),b=n(32),_=(n.n(b),n(2057)),w=n(1982),S=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.state={uiLocale:"en"},o}return o(t,e),C(t,[{key:"componentDidMount",value:function(){var e=this;this.context.d2.currentUser.userSettings.get("keyUiLocale").then(function(t){return e.setState({uiLocale:t})})}},{key:"render",value:function(){var e=s(this.props.value,this.state.uiLocale);return v.a.createElement(i,{value:e})}}]),t}(y.PureComponent);O.contextTypes={d2:g.a.object};var x=/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\.[0-9]{2,3}$/,E=[[h,p],[c,O],[d,l],[u,_.a]],k=function(e){var t=E.map(function(e){return S(e,1)[0]}),n=t.findIndex(function(t){return t(e)});return E[n]&&E[n][1]||i}}).call(t,n(29))},2026:function(e,t){e.exports={"/edit/categorySection/categoryOptionGroupSet":"/en/user/html/manage_category.html#create_category_option_group_set","/edit/categorySection/categoryOptionGroup":"/en/user/html/manage_category.html#create_category_option_group","/edit/categorySection/categoryOptionCombo":"/en/user/html/manage_category.html#assign_code_category_option_combo","/edit/categorySection/categoryOption":"/en/user/html/manage_category.html#create_category_option","/edit/categorySection/categoryCombo":"/en/user/html/manage_category.html#create_category_combination","/edit/categorySection/category":"/en/user/html/manage_category.html#create_category","/list/categorySection":"/en/user/html/manage_category.html","/edit/dataElementSection/dataElementGroupSet":"/en/user/html/manage_data_element.html#create_data_element_group_set","/edit/dataElementSection/dataElementGroup":"/en/user/html/manage_data_element.html#create_data_element_group","/edit/dataElementSection/dataElement":"/en/user/html/manage_data_element.html#create_data_element","/list/dataElementSection":"/en/user/html/manage_data_element.html","/edit/dataSetSection/dataSet/${objectId}/sections":"/en/user/html/manage_data_set.html#manage_section_form","/edit/dataSetSection/dataSet":"/en/user/html/manage_data_set.html#create_data_set","/list/dataSetSection/dataSet":"/en/user/html/manage_data_set.html","/edit/indicatorSection/programIndicatorGroup":"/en/user/html/configure_program_indicator.html#create_program_indicator_group","/list/indicatorSection/programIndicatorGroup":"/en/user/html/configure_program_indicator.html","/edit/indicatorSection/programIndicator":"/en/user/html/configure_program_indicator.html#create_program_indicator","/list/indicatorSection/programIndicator":"/en/user/html/configure_program_indicator.html","/edit/indicatorSection/indicatorGroupSet":"/en/user/html/manage_indicator.html#create_indicator_group_set","/edit/indicatorSection/indicatorGroup":"/en/user/html/manage_indicator.html#create_indicator_group","/edit/indicatorSection/indicatorType":"/en/user/html/manage_indicator.html#create_indicator_type","/edit/indicatorSection/indicator":"/en/user/html/manage_indicator.html#create_indicator","/list/indicatorSection":"/en/user/html/manage_indicator.html","/edit/organisationUnitSection/organisationUnitGroupSet":"/en/user/html/manage_organisation_unit.html#create_organisation_unit_group_set","/edit/organisationUnitSection/organisationUnitGroup":"/en/user/html/manage_organisation_unit.html#create_organisation_unit_group","/edit/organisationUnitSection/organisationUnitLevel":"/en/user/html/manage_organisation_unit.html#name_organisation_unit_level","/edit/organisationUnitSection/organisationUnit":"/en/user/html/manage_organisation_unit.html#create_organisation_unit","/list/organisationUnitSection":"/en/user/html/manage_organisation_unit.html","/edit/programSection/trackedEntityAttribute":"/en/user/html/configure_tracked_entity.html#create_tracked_entity_attribute","/edit/programSection/programRuleVariable":"/en/user/html/configure_program_rule.html#create_program_rule_variable","/edit/programSection/relationshipType":"/en/user/html/configure_relationship_type.html#create_relationship_type","/edit/programSection/trackedEntity":"/en/user/html/configure_tracked_entity.html#about_tracked_entity","/edit/programSection/programRule":"/en/user/html/configure_program_rule.html#create_program_rule","/edit/programSection/program":"/en/user/html/configure_event_program_in_maintenance_app.html#create_event_program","/list/programSection":"/en/user/html/configure_programs_in_maintenance_app.html","/edit/validationSection/validationNotificationTemplate":"/en/user/html/manage_validation_rule.html#create_validation_notification","/edit/validationSection/validationRuleGroup":"/en/user/html/manage_validation_rule.html#create_validation_rule_group","/edit/validationSection/validationRule":"/en/user/html/manage_validation_rule.html#create_validation_rule","/list/validationSection":"/en/user/html/manage_validation_rule.html","/edit/otherSection/legendSet":"/en/user/html/manage_legend.html#create_legend","/list/otherSection/legendSet":"/en/user/html/manage_legend.html","/edit/otherSection/pushAnalysis":"/en/user/html/manage_push_report.html#create_push_report","/list/otherSection/pushAnalysis":"/en/user/html/manage_push_report.html","/edit/otherSection/externalMapLayer":"/en/user/html/manage_external_maplayer.html#create_external_map_layer","/list/otherSection/externalMapLayer":"/en/user/html/manage_external_maplayer.html","/edit/otherSection/predictorGroup":"/en/user/html/manage_predictor.html#create_predictor_group","/list/otherSection/predictorGroup":"/en/user/html/manage_predictor.html","/edit/otherSection/${objectType}":"/en/user/html/manage_${objectType}.html#create_${objectType}","/list/otherSection/${objectType}":"/en/user/html/manage_${objectType}.html"}},2035:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(24),d=(n.n(u),n(789)),p=n.n(d),h=n(2061),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=function(e){function t(e,o){r(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return i.i18n=o.d2.i18n,i.state={TranslationForm:n.i(h.a)(i.props.objectToTranslate)},i.translationSaved=i.translationSaved.bind(i),i.translationError=i.translationError.bind(i),i.closeTranslationDialog=i.closeTranslationDialog.bind(i),i}return o(t,e),m(t,[{key:"render",value:function(){return s.a.createElement(p.a,f({title:this.i18n.getTranslation("translation_dialog_title"),autoDetectWindowHeight:!0,autoScrollBodyContent:!0},this.props),s.a.createElement(this.state.TranslationForm,{onTranslationSaved:this.translationSaved,onTranslationError:this.translationError,onCancel:this.closeTranslationDialog,fieldsToTranslate:this.props.fieldsToTranslate}))}},{key:"componentWillReceiveProps",value:function(e){e.objectToTranslate&&this.setState({TranslationForm:n.i(h.a)(e.objectToTranslate)})}},{key:"closeTranslationDialog",value:function(){this.props.onRequestClose()}},{key:"translationSaved",value:function(e){this.props.onTranslationSaved(e),this.closeTranslationDialog()}},{key:"translationError",value:function(e){this.props.onTranslationError(e)}}]),t}(i.Component);g.propTypes={objectToTranslate:c.a.shape({id:c.a.string.isRequired}).isRequired,onTranslationSaved:c.a.func.isRequired,onTranslationError:c.a.func.isRequired,open:c.a.bool,onRequestClose:c.a.func.isRequired,fieldsToTranslate:c.a.array},g.contextTypes={d2:c.a.object},t.a=g},2054:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){var n=Object.keys(e.actions).filter(function(t){return"function"==typeof e.actions[t]}),a={position:"fixed",left:-1e3,transition:"left 0s, top 0s"},o=(e.actions,e.activeItem),i=e.icons,s=r(e,["actions","activeItem","icons"]);return l.a.createElement(g.a,_({},s,{open:Boolean(e.activeItem),anchorEl:e.target,anchorOrigin:{horizontal:"middle",vertical:"center"},animated:!1,style:a,animation:v.a}),l.a.createElement(u.a,{className:"data-table__context-menu",desktop:!0},n.map(function(n){var r=i&&i[n]?i[n]:n,a=function(){"function"==typeof e.onRequestClose&&e.onRequestClose(),e.actions[n].apply(e.actions,[e.activeItem])};return l.a.createElement(p.a,{key:n,"data-object-id":o&&o.id,className:"data-table__context-menu__item",onClick:a,primaryText:t.d2.i18n.getTranslation(n),leftIcon:l.a.createElement(f.a,{className:"material-icons"},r)})})))}var o=n(1),i=n.n(o),s=n(0),l=n.n(s),c=n(402),u=n.n(c),d=n(235),p=n.n(d),h=n(167),f=n.n(h),m=n(107),g=n.n(m),y=n(50),v=n.n(y),b=n(389),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};a.defaultProps={icons:{},actions:{}},a.propTypes={actions:i.a.objectOf(i.a.func),activeItem:i.a.object,icons:i.a.object,target:i.a.object,onRequestClose:i.a.func},t.a=n.i(b.a)(a)},2055:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(123),d=n.n(u),p=n(21),h=n.n(p),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o.context.d2.i18n;return o.getTranslation=i.getTranslation.bind(i),o}return o(t,e),f(t,[{key:"render",value:function(){var e=h()("data-table__headers__header",{"data-table__headers__header--even":!this.props.isOdd,"data-table__headers__header--odd":this.props.isOdd});return s.a.createElement("div",{className:e},this.props.name?this.getTranslation(d()(this.props.name)):null,this.props.children)}}]),t}(i.Component);m.propTypes={isOdd:c.a.bool,name:c.a.string},m.contextTypes={d2:c.a.object},t.a=m},2056:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){return e&&e.modelDefinition&&e.modelDefinition.modelValidations&&e.modelDefinition.modelValidations[t]&&e.modelDefinition.modelValidations[t].type}var s=n(0),l=n.n(s),c=n(1),u=n.n(c),d=n(21),p=n.n(d),h=n(32),f=(n.n(h),n(104)),m=n.n(f),g=n(167),y=n.n(g),v=n(2068),b=n.n(v),_=n(389),w=n(2021),S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),T=n.i(_.a)(function(e){function t(){var e,n,o,i;r(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=o=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.iconMenuClick=function(e){o.props.itemClicked(e,o.props.dataSource)},o.singleActionClick=function(){o.hasSingleAction()&&o.singleAction().action(o.props.dataSource)},o.handleContextClick=function(e){e&&e.preventDefault(),o.props.itemClicked(e,o.props.dataSource)},o.handleClick=function(e){o.props.primaryClick(o.props.dataSource,e)},o.hasContextMenu=function(){return Object.keys(o.props.contextMenuActions||{}).length>1},o.hasSingleAction=function(){return 1===Object.keys(o.props.contextMenuActions||{}).length},o.singleAction=function(){if(o.hasSingleAction()){var e=Object.keys(o.props.contextMenuActions||{}),t=e[0];return{label:t,action:o.props.contextMenuActions[t],icon:o.props.contextMenuIcons&&o.props.contextMenuIcons[t]?o.props.contextMenuIcons[t]:t}}return null},i=n,a(o,i)}return o(t,e),S(t,[{key:"render",value:function(){var e=this,t=p()("data-table__rows__row",{"data-table__rows__row--even":!this.props.isOdd,"data-table__rows__row--odd":this.props.isOdd}),r=this.props.columns.map(function(t,r){var a={valueType:i(e.props.dataSource,t),value:e.props.dataSource[t],columnName:t},o=n.i(w.a)(a);return l.a.createElement("div",{key:r,className:"data-table__rows__row__column",onContextMenu:e.handleContextClick,onClick:e.handleClick},l.a.createElement(o,a))});return l.a.createElement("div",{className:t},r,this.hasContextMenu()&&l.a.createElement("div",{className:"data-table__rows__row__column",style:{width:"1%"}},l.a.createElement(m.a,{tooltip:this.context.d2.i18n.getTranslation("actions"),onClick:this.iconMenuClick},l.a.createElement(b.a,null))),this.hasSingleAction()&&l.a.createElement("div",{className:"data-table__rows__row__column",style:{width:"1%"}},l.a.createElement(m.a,{tooltip:this.context.d2.i18n.getTranslation(this.singleAction().label),onClick:this.singleActionClick},l.a.createElement(y.a,{className:"material-icons"},this.singleAction().icon))))}}]),t}(s.Component));T.propTypes={columns:u.a.arrayOf(u.a.string).isRequired,dataSource:u.a.object,isEven:u.a.bool,isOdd:u.a.bool,itemClicked:u.a.func.isRequired,primaryClick:u.a.func.isRequired,contextMenuActions:u.a.object,contextMenuIcons:u.a.object},t.a=T},2057:function(e,t,n){"use strict";function r(e){var t=e.value,r={color:{backgroundColor:t,color:n.i(i.a)(t).l<70?"#FFF":"#000",textAlign:"center",position:"relative",width:90,height:36,lineHeight:2.5,boxShadow:"0 1px 6px rgba(0,0,0,0.12),0 1px 4px rgba(0,0,0,0.12)"}};return o.a.createElement("div",{style:r.color},t)}t.a=r;var a=n(0),o=n.n(a),i=n(1992)},2059:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return function(t){var n=Array.prototype.findIndex.call(e,function(e){return e===t});if(n<e.length-1){var r=e[n+1];e[n+1]=e[n],e[n]=r}}}function l(e){return function(t){var n=Array.prototype.findIndex.call(e,function(e){return e===t});if(n>0){var r=e[n-1];e[n-1]=e[n],e[n]=r}}}var c=n(0),u=n.n(c),d=n(1),p=n.n(d),h=n(391),f=n.n(h),m=n(23),g=n.n(m),y=n(1991),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_={wrapper:{paddingRight:"2.5rem",position:"relative"},arrowsDiv:{width:"2.5rem",position:"absolute",top:"45%",right:0},arrow:{color:"rgb(33, 150, 243)"}},w=function(e){function t(){var e,n,r,i;a(this,t);for(var c=arguments.length,u=Array(c),d=0;d<c;d++)u[d]=arguments[d];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.setRef=function(e){r.groupEditor=e},r.moveUp=function(){if(!Array.isArray(r.props.assignedItemStore.getState()))return g.a.warn("Moving in <GroupEditorWithOrdering /> is not supported (yet) when the assignedItemStore's state is a ModelCollectionProperty");var e=Array.from(r.props.assignedItemStore.getState());r.groupEditor.getSelectedItems().forEach(l(e)),r.props.onOrderChanged(e)},r.moveDown=function(){if(!Array.isArray(r.props.assignedItemStore.getState()))return g.a.warn("Moving in <GroupEditorWithOrdering /> is not supported (yet) when the assignedItemStore's state is a ModelCollectionProperty");var e=Array.from(r.props.assignedItemStore.getState());r.groupEditor.getSelectedItems().reverse().forEach(s(e)),r.props.onOrderChanged(e)},i=n,o(r,i)}return i(t,e),b(t,[{key:"render",value:function(){var e=this.props,t=(e.onOrderChanged,r(e,["onOrderChanged"]));return u.a.createElement("div",{style:_.wrapper},u.a.createElement(y.a,v({ref:this.setRef},t)),u.a.createElement("div",{style:_.arrowsDiv},u.a.createElement(f.a,{style:_.arrow,iconClassName:"material-icons",tooltip:"Move up",onClick:this.moveUp},"arrow_upward"),u.a.createElement(f.a,{style:_.arrow,iconClassName:"material-icons",tooltip:"Move down",onClick:this.moveDown},"arrow_downward")))}}]),t}(c.Component);w.propTypes={onOrderChanged:p.a.func,assignedItemStore:p.a.object.isRequired},w.defaultProps={onOrderChanged:function(){}},t.a=w},2060:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(788),d=n.n(u),p=n(234),h=n.n(p),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.onLocaleChange=function(e,t,n){o.setState({locale:n}),o.props.onChange(n,e)};var i=o.context.d2.i18n;return o.getTranslation=i.getTranslation.bind(i),o}return o(t,e),m(t,[{key:"render",value:function(){var e=[{payload:"",text:""}].concat(this.props.locales).map(function(e,t){return s.a.createElement(h.a,{key:t,primaryText:e.name,value:e.locale})});return s.a.createElement(d.a,f({fullWidth:!0},this.props,{value:this.state&&this.state.locale,hintText:this.getTranslation("select_locale"),onChange:this.onLocaleChange}),e)}}]),t}(i.Component);g.propTypes={value:c.a.string,locales:c.a.arrayOf(c.a.shape({name:c.a.string.isRequired,locale:c.a.string.isRequired})).isRequired,onChange:c.a.func.isRequired},g.contextTypes={d2:c.a.object},t.a=g},2061:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=S.a.create();return n.i(_.a)(e).subscribe(function(e){t.setState(e)}),v.Observable.combineLatest(n.i(_.b)(),t,function(){for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return Object.assign.apply(Object,[{objectToTranslate:e,setTranslations:function(e){t.setState({translations:e})}}].concat(r))})}function s(e){return n.i(w.a)(i(e),O)}t.a=s;var l=n(0),c=n.n(l),u=n(1),d=n.n(u),p=n(780),h=n.n(p),f=n(123),m=n.n(f),g=n(781),y=n.n(g),v=n(28),b=(n.n(v),n(2060)),_=n(2062),w=n(794),S=n(48),T=n(782),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O=function(e){function t(e,o){r(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));i.state={loading:!0,translations:{},translationValues:{},currentSelectedLocale:""},i.setCurrentLocale=function(e){i.setState({currentSelectedLocale:e})},i.setValue=function(e,t){var n=[].concat(i.props.translations),r=n.find(function(t){return t.locale===i.state.currentSelectedLocale&&t.property.toLowerCase()===m()(e)});r?t.target.value?r.value=t.target.value:n=n.filter(function(e){return e!==r}):(r={property:m()(e).toUpperCase(),locale:i.state.currentSelectedLocale,value:t.target.value},n.push(r)),i.props.setTranslations(n)},i.saveTranslations=function(){n.i(_.c)(i.props.objectToTranslate,i.props.translations).subscribe(i.props.onTranslationSaved,i.props.onTranslationError)};var s=i.context.d2.i18n;return i.getTranslation=s.getTranslation.bind(s),i}return o(t,e),C(t,[{key:"getLoadingdataElement",value:function(){return c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(T.a,{mode:"indeterminate"}))}},{key:"renderFieldsToTranslate",value:function(){var e=this;return this.props.fieldsToTranslate.filter(function(e){return e}).map(function(t){return c.a.createElement("div",{key:t},c.a.createElement(h.a,{floatingLabelText:e.getTranslation(m()(t)),value:e.getTranslationValueFor(t),fullWidth:!0,onChange:e.setValue.bind(e,t)}),c.a.createElement("div",null,e.props.objectToTranslate[t]))})}},{key:"renderForm",value:function(){return c.a.createElement("div",null,this.renderFieldsToTranslate(),c.a.createElement(y.a,{label:this.getTranslation("save"),primary:!0,onClick:this.saveTranslations}),c.a.createElement(y.a,{style:{marginLeft:"1rem"},label:this.getTranslation("cancel"),onClick:this.props.onCancel}))}},{key:"renderHelpText",value:function(){return c.a.createElement("div",null,c.a.createElement("p",null,this.getTranslation("select_a_locale_to_enter_translations_for_that_language")))}},{key:"render",value:function(){return this.props.locales||this.props.translations?c.a.createElement("div",{style:{minHeight:250}},c.a.createElement(b.a,{locales:this.props.locales,onChange:this.setCurrentLocale}),this.state.currentSelectedLocale?this.renderForm():this.renderHelpText()):this.getLoadingdataElement()}},{key:"getTranslationValueFor",value:function(e){var t=this,n=this.props.translations.find(function(n){return n.locale===t.state.currentSelectedLocale&&n.property.toLowerCase()===m()(e)});if(n)return n.value}}]),t}(l.Component);O.propTypes={onTranslationSaved:d.a.func.isRequired,onTranslationError:d.a.func.isRequired,objectToTranslate:d.a.shape({id:d.a.string.isRequired}),fieldsToTranslate:d.a.arrayOf(d.a.string)},O.defaultProps={fieldsToTranslate:["name","shortName","description"]},O.contextTypes={d2:d.a.object}},2062:function(e,t,n){"use strict";function r(){return r.localePromise||(r.localePromise=n.i(i.getInstance)().then(function(e){return e.Api.getApi().get("locales/db")}).then(function(e){return{locales:e}})),s.Observable.fromPromise(r.localePromise)}function a(e){return e.href?e.href:e.modelDefinition.apiEndpoint+"/"+e.id}function o(e){return s.Observable.of(e).flatMap(function(e){var t=e.modelDefinition;return t||t.name?n.i(i.getInstance)().then(function(t){return t.Api.getApi().get(a(e)+"/translations")}):Promise.reject(new Error("Can not find modelDefinition for "+e.id))})}t.b=r,t.a=o,n.d(t,"c",function(){return u});var i=n(24),s=(n.n(i),n(28)),l=(n.n(s),n(124)),c=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=l.a.create("saveTranslations");u.subscribe(function(e){var t=c(e.data,2),r=t[0],o=t[1],s=e.complete,l=e.error,u=a(r)+"/translations";n.i(i.getInstance)().then(function(e){e.Api.getApi().update(u,{translations:o},{dataType:"text"}).then(function(){return s(o)}).catch(l)})})},2065:function(e,t,n){"use strict";function r(e){if(e instanceof o)return new o(e.h,e.s,e.l,e.opacity);e instanceof s.a||(e=n.i(s.b)(e));var t=e.r/255,r=e.g/255,a=e.b/255,i=(g*a+f*t-m*r)/(g+f-m),c=a-i,u=(h*(r-i)-d*c)/p,y=Math.sqrt(u*u+c*c)/(h*i*(1-i)),v=y?Math.atan2(u,c)*l.a-120:NaN;return new o(v<0?v+360:v,y,i,e.opacity)}function a(e,t,n,a){return 1===arguments.length?r(e):new o(e,t,n,null==a?1:a)}function o(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}t.a=a;var i=n(1990),s=n(1989),l=n(1999),c=-.14861,u=1.78277,d=-.29227,p=-.90649,h=1.97294,f=h*p,m=h*u,g=u*d-p*c;n.i(i.a)(o,a,n.i(i.b)(s.c,{brighter:function(e){return e=null==e?s.d:Math.pow(s.d,e),new o(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?s.e:Math.pow(s.e,e),new o(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*l.b,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new s.a(255*(t+n*(c*r+u*a)),255*(t+n*(d*r+p*a)),255*(t+n*(h*r)),this.opacity)}}))},2066:function(e,t,n){"use strict";function r(e){if(e instanceof o)return new o(e.l,e.a,e.b,e.opacity);if(e instanceof p){if(isNaN(e.h))return new o(e.l,0,0,e.opacity);var t=e.h*m.b;return new o(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof f.a||(e=n.i(f.b)(e));var r,a,s=c(e.r),l=c(e.g),u=c(e.b),d=i((.2225045*s+.7168786*l+.0606169*u)/y);return s===l&&l===u?r=a=d:(r=i((.4360747*s+.3850649*l+.1430804*u)/g),a=i((.0139322*s+.0971045*l+.7141733*u)/v)),new o(116*d-16,500*(r-d),200*(d-a),e.opacity)}function a(e,t,n,a){return 1===arguments.length?r(e):new o(e,t,n,null==a?1:a)}function o(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function i(e){return e>S?Math.pow(e,1/3):e/w+b}function s(e){return e>_?e*e*e:w*(e-b)}function l(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function c(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function u(e){if(e instanceof p)return new p(e.h,e.c,e.l,e.opacity);if(e instanceof o||(e=r(e)),0===e.a&&0===e.b)return new p(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*m.a;return new p(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function d(e,t,n,r){return 1===arguments.length?u(e):new p(e,t,n,null==r?1:r)}function p(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}t.b=a,t.a=d;var h=n(1990),f=n(1989),m=n(1999),g=.96422,y=1,v=.82521,b=4/29,_=6/29,w=3*_*_,S=_*_*_;n.i(h.a)(o,a,n.i(h.b)(f.c,{brighter:function(e){return new o(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new o(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=g*s(t),e=y*s(e),n=v*s(n),new f.a(l(3.1338561*t-1.6168667*e-.4906146*n),l(-.9787684*t+1.9161415*e+.033454*n),l(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),n.i(h.a)(p,d,n.i(h.b)(f.c,{brighter:function(e){return new p(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new p(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return r(this).rgb()}}))},2068:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=r(a),i=n(40),s=r(i),l=n(37),c=r(l),u=function(e){return o.default.createElement(c.default,e,o.default.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}))};u=(0,s.default)(u),u.displayName="NavigationMoreVert",u.muiName="SvgIcon",t.default=u},2070:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){var a=e.level,o=e.schema,s=e.children,l=e.groupName,c=e.isDirtyHandler,m=e.skipTranslation,g=r(e,["level","schema","children","groupName","isDirtyHandler","skipTranslation"]);return i.a.createElement(u.a,f({},g,{level:a}),i.a.createElement(p.a,{onClick:function(){return n.i(h.b)("/list/"+l+"/"+o)},iconStyle:{top:3},isDirtyHandler:c}),m?s:t.d2.i18n.getTranslation(s),o&&i.a.createElement(d.a,{schema:o}))}var o=n(0),i=n.n(o),s=n(1),l=n.n(s),c=n(389),u=n(1979),d=n(2015),p=n(2077),h=n(106),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};a.propTypes={children:l.a.oneOfType([l.a.string,l.a.array]),level:l.a.number,isDirtyHandler:l.a.func,schema:l.a.string.isRequired,groupName:l.a.string.isRequired,skipTranslation:l.a.bool},a.defaultProps={isDirtyHandler:function(){},level:2,children:"",skipTranslation:!1},t.a=n.i(c.a)(a)},2077:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){var n=e.tooltip,a=e.onClick,o=e.isDirtyHandler,s=void 0===o?u.a.getState.bind(u.a):o,c=r(e,["tooltip","onClick","isDirtyHandler"]),p=function(){s&&s()&&s().dirty?confirm(t.d2.i18n.getTranslation("abandon_unsaved_changes"))&&a.apply(void 0,arguments):a.apply(void 0,arguments)};return i.a.createElement(l.a,d({tooltip:n||t.d2.i18n.getTranslation("back"),tooltipPosition:"bottom-right",onClick:p},c,{iconClassName:"material-icons"}),"")}var o=n(0),i=n.n(o),s=n(391),l=n.n(s),c=n(389),u=n(233),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};a.propTypes={tooltip:i.a.PropTypes.string},t.a=n.i(c.a)(a)},2185:function(e,t,n){"use strict";function r(e){var t=e.style,n=void 0===t?{}:t,r=e.large,a=void 0!==r&&r,o=e.small,i=void 0!==o&&o;return s.a.createElement("div",{style:Object.assign({},c,n)},s.a.createElement(l.a,{large:a,small:i}))}t.a=r;var a=n(1),o=n.n(a),i=n(0),s=n.n(i),l=n(782),c={left:"45%",position:"fixed",top:"45%"};r.propTypes={style:o.a.object,large:o.a.bool,small:o.a.bool}},2359:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e){var t=e.level,n=e.children,a=r(e,["level","children"]),o=Object.assign({},c,a.style);return i.a.createElement(s.a,l({},a,{style:o,level:t||3}),n)}var o=n(0),i=n.n(o),s=n(1979),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c={fontSize:"1.25rem",paddingTop:".5rem",fontWeight:100};a.propTypes={children:i.a.PropTypes.string,level:i.a.PropTypes.number},t.a=a},2469:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=n(0),c=n.n(l),u=n(23),d=n.n(u),p=n(789),h=n.n(p),f=n(786),m=n.n(f),g=n(781),y=n.n(g),v=n(808),b=n.n(v),_=n(1978),w=n(72),S=n(233),T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O={dialogContent:{maxWidth:"none"},dialogDiv:{overflowX:"auto",overflowY:"hidden"},table:{borderSpacing:0,borderCollapse:"collapse",margin:"32px auto"},th:{whiteSpace:"nowrap",textAlign:"center",border:"1px solid #e0e0e0",padding:6},thDataElements:{whiteSpace:"nowrap",border:"1px solid #e0e0e0",background:"#f0f0f0",textAlign:"left",padding:6},td:{whiteSpace:"nowrap",padding:2,border:"1px solid #e0e0e0",minWidth:105},tdDataElement:{whiteSpace:"nowrap",padding:6,border:"1px solid #e0e0e0"}},x=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={categories:[]},r.closeDialog=r.closeDialog.bind(r),r.handleSaveClick=r.handleSaveClick.bind(r),r.getTranslation=n.d2.i18n.getTranslation.bind(n.d2.i18n),r}return s(t,e),C(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.context.d2;if(e.sectionModel){if(e.sectionModel.dataElements.toArray().length<1)return d.a.info("Section "+e.sectionModel.displayName+" contains no data elements"),w.a.show({message:this.getTranslation("this_section_has_no_data_elements"),action:"ok"}),void this.props.onRequestClose();var r={},a=function(e){for(var t=null,n=function(e,n){var r=e;return r[n.id]=t,r};e.length>0;)t=e.pop().categoryOptions.toArray().reduce(n,{});return t},o=function e(t,n,r){return n.length>0?Object.keys(t).reduce(function(a,o){var i=a,s=n.indexOf(o);return-1!==s?(n.splice(s,1),i[o]=e(t[o],n,r),i):(i[o]=t[o],i)},{}):r};n.models.categoryCombos.list({filter:"id:in:["+e.sectionModel.categoryCombos.toArray().map(function(e){return e.id})+"]",paging:!1,fields:["id,displayName","categories[id,displayName,categoryOptions[id,displayName]]","categoryOptionCombos[id,displayName","categoryOptions[id,displayName]]"].join(",")}).then(function(n){n.forEach(function(e){Object.assign(r,JSON.parse(JSON.stringify(a(e.categories.toArray())))),e.categoryOptionCombos.toArray().forEach(function(e){var t=e.categoryOptions.toArray().map(function(e){return e.id});r=o(r,t,{id:e.id,displayName:e.displayName})})});var i=e.sectionModel.greyedFields.reduce(function(e,t){if(e.hasOwnProperty(t.dataElement.id))return e[t.dataElement.id].push(t.categoryOptionCombo.id),e;var n=e;return n[t.dataElement.id]=[t.categoryOptionCombo.id],n},{});t.setState({currentCategoryCombo:n.toArray()[0].id,categoryCombos:n,optionCount:n.toArray().reduce(function(e,t){return e[t.id]=t.categories.toArray().map(function(e){return e.categoryOptions.size}),e},{}),cocMap:r,greyedFields:i})})}}},{key:"closeDialog",value:function(){this.props.onRequestClose()}},{key:"handleSaveClick",value:function(){var e=this,t=[];Object.keys(this.state.greyedFields).forEach(function(n){e.state.greyedFields[n].forEach(function(e){t.push({dataElement:{id:n},categoryOptionCombo:{id:e}})})});var n=Object.assign(this.props.sectionModel,{greyedFields:t});n.save().then(function(t){d.a.info("Section updated",t),w.a.show({message:e.getTranslation("section_saved")}),e.props.onRequestSave(n)}).catch(function(t){d.a.error("Failed to save section:",t),w.a.show({message:e.getTranslation("failed_to_save_section"),action:"ok"})})}},{key:"renderTableHeader",value:function(){var e=this,t=1;return this.state.currentCategoryCombo&&this.state.categoryCombos.get(this.state.currentCategoryCombo).categories.toArray().map(function(n,r){var o=e.state.optionCount[e.state.currentCategoryCombo].slice(r+1).reduce(function(e,t){return t*e},1),i=r===e.state.categoryCombos.get(e.state.currentCategoryCombo).categories.size-1,s=c.a.createElement("tr",{key:r},c.a.createElement("th",{style:O.thDataElements},i&&e.getTranslation("data_element")),Array.apply(void 0,a(Array(t))).map(function(e,t){return n.categoryOptions.toArray().map(function(e,n){return c.a.createElement("th",{key:n+"."+t,colSpan:o,style:O.th},"default"===e.displayName?"":e.displayName)})}));return t*=n.categoryOptions.size,s})}},{key:"renderCheckbox",value:function(e,t,n){var r=this,a=function e(t,n){return 0===n.length?t:e(t[n.shift()],n)}(this.state.cocMap,t),o=this.state.greyedFields.hasOwnProperty(e.id)&&-1!==this.state.greyedFields[e.id].indexOf(a.id),i=function(e,t,n,a){r.setState(function(n){var r=(n.greyedFields[e]||[]).slice();a?r.includes(t)&&r.splice(r.indexOf(t),1):r.includes(t)||r.push(t);var o=Object.keys(n.greyedFields).reduce(function(t,a){var o=t;return o[a]=a===e?r:n.greyedFields[a],o},{});return r.length>0&&!o.hasOwnProperty(e)&&(o[e]=r),{greyedFields:o}})}.bind(this,e.id,a.id);return c.a.createElement("td",{key:n,style:O.td},c.a.createElement(b.a,{checked:!o,label:o?this.getTranslation("disabled"):this.getTranslation("enabled"),labelPosition:"right",labelStyle:{whiteSpace:"nowrap"},onCheck:i}))}},{key:"renderDataElements",value:function(){var e=this,t=function(){return e.state.categoryCombos.get(e.state.currentCategoryCombo).categories.toArray().reduce(function(e,t){if(e.length>0){var n=[];return e.forEach(function(e){t.categoryOptions.toArray().forEach(function(t){var r=e.slice();r.push(t.id),n.push(r)})}),n}return t.categoryOptions.toArray().forEach(function(t){e.push([t.id])}),e},[])},n=this.props.sectionModel.dataElements.toArray().map(function(e){return e.id});return this.state.currentCategoryCombo?S.a.state.dataSetElements.filter(function(e){return n.includes(e.dataElement.id)}).filter(function(t){return(t.categoryCombo?t.categoryCombo.id:t.dataElement.categoryCombo.id)===e.state.currentCategoryCombo}).sort(function(e,t){return n.indexOf(e.dataElement.id)-n.indexOf(t.dataElement.id)}).map(function(n,r){var a=t();return c.a.createElement("tr",{key:r,style:{background:r%2==0?"none":"#f0f0f0"}},c.a.createElement("td",{style:O.tdDataElement},n.dataElement.displayName),a.map(function(t,r){return e.renderCheckbox(n.dataElement,t,r)}))}):null}},{key:"render",value:function(){var e=this,t=this.props.sectionModel.displayName,n=this.props,a=n.open,o=r(n,["open"]),i=[],s=[],l=[];return this.props.sectionModel&&(s=this.props.sectionModel.dataElements.toArray().map(function(e){return e.id}),l=S.a.state.dataSetElements.filter(function(e){return s.includes(e.dataElement.id)}).map(function(e){return e.categoryCombo||e.dataElement.categoryCombo}).reduce(function(e,t){return i.includes(t.id)||(i.push(t.id),e.push(t)),e},[]).sort(function(e,t){return e.displayName.localeCompare(t.displayName)})),c.a.createElement(h.a,T({autoScrollBodyContent:!0,autoDetectWindowHeight:!0,title:this.getTranslation("manage_grey_fields")+": "+t,style:{maxWidth:"none"},contentStyle:O.dialogContent,open:a&&this.props.sectionModel.dataElements.size>0},o,{actions:[c.a.createElement(m.a,{label:this.getTranslation("cancel"),onTouchTap:this.closeDialog,style:{marginRight:16}}),c.a.createElement(y.a,{primary:!0,label:this.getTranslation("save"),onTouchTap:this.handleSaveClick})],onRequestClose:this.closeDialog}),this.props.sectionModel&&this.props.sectionModel.categoryCombos&&this.props.sectionModel.categoryCombos.size>1?c.a.createElement(_.a,{options:l.map(function(t){return{value:t.id,text:"default"===t.displayName?e.getTranslation("none"):t.displayName}}),labelText:this.getTranslation("category_combo"),value:this.state.currentCategoryCombo,onChange:function(t){return e.setState({currentCategoryCombo:t.target.value})},style:{width:"33%"},isRequired:!0}):null,c.a.createElement("div",{style:O.dialogDiv},c.a.createElement("table",{style:O.table},c.a.createElement("tbody",null,this.renderTableHeader(),this.state.currentCategoryCombo&&this.props.sectionModel&&this.renderDataElements()))))}}]),t}(c.a.Component);x.contextTypes={d2:c.a.PropTypes.any.isRequired},x.propTypes={open:c.a.PropTypes.bool.isRequired,sectionModel:c.a.PropTypes.any.isRequired,onRequestClose:c.a.PropTypes.func.isRequired,onRequestSave:c.a.PropTypes.func.isRequired},t.a=x},2470:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),s=n.n(i),l=n(23),c=n.n(l),u=n(789),d=n.n(u),p=n(786),h=n.n(p),f=n(781),m=n.n(f),g=n(780),y=n.n(g),v=n(2059),b=n(48),_=n(245),w=n.n(_),S=n(1978),T=n(72),C=n(233),O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),E=b.a.create(),k=b.a.create(),A=b.a.create(),j=b.a.create(),I=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.setAssignedDataElements=function(e){k.setState(e)},o.setAssignedIndicators=function(e){j.setState(e)},o.removeIndicators=function(e){return j.setState(j.state.filter(function(t){return-1===e.indexOf(t)})),Promise.resolve()},o.assignIndicators=function(e){return j.setState(j.state.concat(e)),Promise.resolve()},o.handleRowTotalsChange=function(e,t){o.setState({showRowTotals:t})},o.handleColumnTotalsChange=function(e,t){o.setState({showColumnTotals:t})},o.handleFilterChange=function(e){o.setState({filterText:e.target.value})},o.handleNameChange=function(e){var t=Array.isArray(C.a.getState().sections)?C.a.getState().sections:C.a.getState().sections.toArray(),n=t.filter(function(e){return e.id!==o.props.sectionModel.id}).reduce(function(t,n){return t||n.name===e.target.value},!1);o.setState({name:e.target.value,nameError:n?o.getTranslation("value_not_unique"):""})},o.handleCodeChange=function(e){var t=Array.isArray(C.a.getState().sections)?C.a.getState().sections:C.a.getState().sections.toArray(),n=t.filter(function(e){return e.id!==o.props.sectionModel.id}).reduce(function(t,n){return t||n.code&&n.code===e.target.value},!1);o.setState({code:e.target.value,codeError:n?o.getTranslation("value_not_unique"):""})},o.handleDescriptionChange=function(e){o.setState({description:e.target.value})},o.assignDataElements=function(e){return k.setState(k.state.concat(e)),Promise.resolve()},o.removeDataElements=function(e){return k.setState(k.state.filter(function(t){return-1===e.indexOf(t)})),Promise.resolve()},o.handleCategoryComboChange=function(e){var t=e.target.value;C.a.state.dataSetElements&&E.setState(C.a.state.dataSetElements.filter(function(e){return!t||(e.categoryCombo?e.categoryCombo.id===t:e.dataElement.categoryCombo.id===t)}).filter(function(e){return!o.state.filterDataElementIds||!o.state.filterDataElementIds.includes(e.dataElement.id)}).map(function(e){return{value:e.dataElement.id,text:e.dataElement.displayName}}).sort(function(e,t){return e.text.localeCompare(t.text)})),o.setState({categoryCombo:t})},o.saveSection=function(){if(!o.state.name||0===o.state.name.trim().length)return void T.a.show({message:o.getTranslation("name_is_required"),action:o.getTranslation("ok")});var e=o.props.sectionModel.id?o.props.sectionModel:o.props.sectionModel.modelDefinition.create();Object.assign(e,{dataSet:{id:C.a.state.id},name:o.state.name,code:o.state.code,description:o.state.description,showRowTotals:o.state.showRowTotals,showColumnTotals:o.state.showColumnTotals,dataElements:k.state.map(function(e){return{id:e}}),indicators:j.state.map(function(e){return{id:e}}),sortOrder:o.props.sectionModel.sortOrder||C.a.state.sections.toArray().reduce(function(e,t){return Math.max(e,t.sortOrder+1)},0)}),e.save().then(function(e){T.a.show({message:o.getTranslation("section_saved")}),o.context.d2.models.sections.get(e.response.uid,{fields:[":all,dataElements[id,categoryCombo[id,displayName]]","greyedFields[categoryOptionCombo,dataElement]"].join(",")}).then(function(e){o.props.onSaveSection(e)})}).catch(function(e){c.a.warn("Failed to save section:",e),T.a.show({message:o.getTranslation("failed_to_save_section"),action:o.getTranslation("ok")})})},o.renderFilters=function(){var e=[{value:!1,text:o.getTranslation("no_filter")}].concat(o.props.categoryCombos.sort(function(e,t){return e.text.localeCompare(t.text)}));return s.a.createElement("div",{style:{minWidth:605}},s.a.createElement(S.a,{options:e,labelText:o.getTranslation("category_combo_filter"),onChange:o.handleCategoryComboChange,value:o.state.categoryCombo,isRequired:!0,disabled:1===o.props.categoryCombos.length,style:{width:284}}),s.a.createElement(y.a,{fullWidth:!0,hintText:o.getTranslation("search_available_selected_items"),defaultValue:o.state.filterText,onChange:o.handleFilterChange}))},o.renderAvailableOptions=function(){var e={position:"relative",display:"block",width:"100%",lineHeight:"24px",color:"rgba(0,0,0,0.3)",marginTop:"1.25rem",fontSize:16},t={marginBottom:80};return s.a.createElement("div",null,s.a.createElement("div",{style:t},s.a.createElement("label",{style:e},o.getTranslation("data_elements")),s.a.createElement(v.a,{itemStore:E,assignedItemStore:k,onAssignItems:o.assignDataElements,onRemoveItems:o.removeDataElements,onOrderChanged:o.setAssignedDataElements,height:250,filterText:o.state.filterText})),A.state.length?s.a.createElement("div",{style:t},s.a.createElement("label",{style:e},o.getTranslation("indicators")),s.a.createElement(v.a,{itemStore:A,assignedItemStore:j,onAssignItems:o.assignIndicators,onRemoveItems:o.removeIndicators,onOrderChanged:o.setAssignedIndicators,height:250,filterText:o.state.filterText})):null)},o.state={categoryCombo:!1},E.setState([]),k.setState([]),A.setState([]),j.setState([]),o.getTranslation=n.d2.i18n.getTranslation.bind(n.d2.i18n),o}return o(t,e),x(t,[{key:"componentDidMount",value:function(){var e=this;this.subscriptions=[],this.subscriptions.push(k.subscribe(function(){e.forceUpdate()}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.sectionModel){var n=e.sectionModel.id,r=C.a.state.sections,a=Array.isArray(r)?r:r.toArray(),o=a.filter(function(e){return e.id!==n}),i=o.reduce(function(e,t){return e.concat((Array.isArray(t.dataElements)?t.dataElements:t.dataElements.toArray()).map(function(e){return e.id}))},[]);k.setState(e.sectionModel.dataElements?e.sectionModel.dataElements.toArray().map(function(e){return e.id}):[]),A.setState(C.a.state.indicators.toArray().map(function(e){return{value:e.id,text:e.displayName}}).sort(function(e,t){return e.text.localeCompare(t.text)})),j.setState(e.sectionModel.indicators?e.sectionModel.indicators.toArray().map(function(e){return e.id}):[]),this.setState({name:e.sectionModel.name,code:e.sectionModel.code,nameError:"",codeError:"",description:e.sectionModel.description,showRowTotals:e.sectionModel.showRowTotals,showColumnTotals:e.sectionModel.showColumnTotals,filterText:"",filterDataElementIds:i},function(){t.handleCategoryComboChange({target:{value:!1}}),t.forceUpdate()})}}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach(function(e){return e.unsubscribe()})}},{key:"render",value:function(){var e=this,t=this.getTranslation("add_section"),n=null;this.props.sectionModel.id&&(t=this.getTranslation("edit_section"),n=s.a.createElement("div",{style:{float:"left",padding:8,color:"rgba(0,0,0,0.5)"}},this.getTranslation("section_id"),":",s.a.createElement("span",{style:{fontFamily:"monospace"}},this.props.sectionModel.id)));var r=function(t){e.setState({nameError:t.target.value.trim().length>0?"":e.getTranslation("value_required")})};return s.a.createElement(d.a,O({autoScrollBodyContent:!0,title:t,actions:[n,s.a.createElement(h.a,{label:this.getTranslation("cancel"),onTouchTap:this.props.onRequestClose,style:{marginRight:24}}),s.a.createElement(m.a,{primary:!0,label:this.getTranslation("save"),onTouchTap:this.saveSection})]},this.props),s.a.createElement(y.a,{floatingLabelText:this.getTranslation("name")+" *",value:this.state.name||"",style:{width:"100%"},onChange:this.handleNameChange,errorText:this.state.nameError,onBlur:r}),s.a.createElement(y.a,{floatingLabelText:this.getTranslation("code"),value:this.state.code||"",style:{width:"100%"},onChange:this.handleCodeChange,errorText:this.state.codeError}),s.a.createElement(y.a,{floatingLabelText:this.getTranslation("description"),value:this.state.description||"",style:{width:"100%"},multiLine:!0,onChange:this.handleDescriptionChange}),s.a.createElement(w.a,{label:this.getTranslation("show_row_totals"),checked:this.state.showRowTotals,style:{margin:"16px 0"},onCheck:this.handleRowTotalsChange}),s.a.createElement(w.a,{label:this.getTranslation("show_column_totals"),checked:this.state.showColumnTotals,style:{margin:"16px 0"},onCheck:this.handleColumnTotalsChange}),this.renderFilters(),this.renderAvailableOptions())}}]),t}(s.a.Component);I.propTypes={open:s.a.PropTypes.bool.isRequired,sectionModel:s.a.PropTypes.any.isRequired,categoryCombos:s.a.PropTypes.array.isRequired,onRequestClose:s.a.PropTypes.func.isRequired,onSaveSection:s.a.PropTypes.func.isRequired},I.contextTypes={d2:s.a.PropTypes.any.isRequired},t.a=I}});
//# sourceMappingURL=5-df7862ac202268f162ba.js.map